# Prismax Backend æµ‹è¯•æ¡†æ¶ä½¿ç”¨æŒ‡å— ğŸš€

## ğŸ“‹ ç›®å½•

1. [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
2. [è™šæ‹Ÿç¯å¢ƒä½¿ç”¨](#è™šæ‹Ÿç¯å¢ƒä½¿ç”¨)
3. [è¿è¡Œæµ‹è¯•](#è¿è¡Œæµ‹è¯•)
4. [æµ‹è¯•æŠ¥å‘Š](#æµ‹è¯•æŠ¥å‘Š)
5. [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç¯å¢ƒé…ç½®

### âœ… å·²éªŒè¯çš„åŠŸèƒ½

1. **ç”¨æˆ·ç®¡ç†æœåŠ¡** - https://user.prismaxserver.com
   - âœ… å¥åº·æ£€æŸ¥æ¥å£æ­£å¸¸
   - âœ… HTTPè¯·æ±‚å°è£…å·¥ä½œæ­£å¸¸
   - âœ… æ—¥å¿—è®°å½•å®Œæ•´

2. **æœºå™¨äººæ§åˆ¶æœåŠ¡** - https://teleop.prismaxserver.com/
   - âœ… æœºå™¨äººçŠ¶æ€æ¥å£æ­£å¸¸
   - âœ… è¿”å›å®æ—¶æœºå™¨äººæ•°æ® (arm1: 220äººé˜Ÿåˆ—, arm2: å¯ç”¨)
   - âœ… æ•°æ®éªŒè¯é€šè¿‡

### ğŸ› ï¸ ç¯å¢ƒé…ç½®

**å½“å‰ç¯å¢ƒ**: Beta
- ç”¨æˆ·ç®¡ç†: https://user.prismaxserver.com
- æœºå™¨äººæ§åˆ¶: https://teleop.prismaxserver.com/

**åˆ‡æ¢ç¯å¢ƒ**:
```bash
# ä½¿ç”¨æœ¬åœ°ç¯å¢ƒ
export TEST_ENV=local

# ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒ
export TEST_ENV=live
```

### ğŸ“Š æµ‹è¯•ç¯å¢ƒçŠ¶æ€

```
Python: 3.12.8 (testenv)
pytest: 7.4.3
ä¾èµ–åŒ…: 29ä¸ªå·²å®‰è£…
æµ‹è¯•çŠ¶æ€: âœ… æ­£å¸¸è¿è¡Œ
```

---

## è™šæ‹Ÿç¯å¢ƒä½¿ç”¨

### ğŸš€ ä¸‰ç§ä½¿ç”¨æ–¹å¼

#### æ–¹å¼1: æ‰‹åŠ¨æ¿€æ´»ï¼ˆæ¨èï¼‰

```bash
cd /Users/wanxin/PycharmProjects/Knowlege_PrismaX/QA_PrismaX/backend-test/Test_Framework

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source testenv/bin/activate

# ç°åœ¨å¯ä»¥è¿è¡Œæµ‹è¯•
pytest -v

# å®Œæˆåé€€å‡º
deactivate
```

#### æ–¹å¼2: ä½¿ç”¨æ¿€æ´»è„šæœ¬

```bash
cd /Users/wanxin/PycharmProjects/Knowlege_PrismaX/QA_PrismaX/backend-test/Test_Framework

# ä¸€é”®æ¿€æ´»
./activate.sh
```

#### æ–¹å¼3: ä¸€è¡Œå‘½ä»¤è¿è¡Œæµ‹è¯•

```bash
cd /Users/wanxin/PycharmProjects/Knowlege_PrismaX/QA_PrismaX/backend-test/Test_Framework
source testenv/bin/activate && pytest -v
```

### ğŸ’¡ å¦‚ä½•ç¡®è®¤åœ¨è™šæ‹Ÿç¯å¢ƒä¸­ï¼Ÿ

**æ–¹æ³•1: æŸ¥çœ‹å‘½ä»¤æç¤ºç¬¦**
```bash
# æ¿€æ´»å‰
user@host:~/Test_Framework$

# æ¿€æ´»åï¼ˆæ³¨æ„å‰é¢çš„ (testenv)ï¼‰
(testenv) user@host:~/Test_Framework$
```

**æ–¹æ³•2: æŸ¥çœ‹Pythonè·¯å¾„**
```bash
which python
# åœ¨è™šæ‹Ÿç¯å¢ƒä¸­: /Users/wanxin/.../testenv/bin/python
# ä¸åœ¨è™šæ‹Ÿç¯å¢ƒ: /usr/local/bin/python3
```

**æ–¹æ³•3: æ£€æŸ¥ç¯å¢ƒå˜é‡**
```bash
echo $VIRTUAL_ENV
# åœ¨è™šæ‹Ÿç¯å¢ƒä¸­: /Users/wanxin/.../testenv
# ä¸åœ¨è™šæ‹Ÿç¯å¢ƒ: (ç©º)
```

### ğŸ”§ è™šæ‹Ÿç¯å¢ƒç®¡ç†

**æŸ¥çœ‹å·²å®‰è£…çš„åŒ…**:
```bash
source testenv/bin/activate
pip list
```

**å®‰è£…æ–°åŒ…**:
```bash
source testenv/bin/activate
pip install package-name
pip freeze > requirements.txt  # æ›´æ–°ä¾èµ–åˆ—è¡¨
```

**é‡å»ºè™šæ‹Ÿç¯å¢ƒ**:
```bash
# åˆ é™¤æ—§ç¯å¢ƒ
rm -rf testenv

# åˆ›å»ºæ–°ç¯å¢ƒ
python3 -m venv testenv

# æ¿€æ´»å¹¶å®‰è£…ä¾èµ–
source testenv/bin/activate
pip install -r requirements.txt
```

---

## è¿è¡Œæµ‹è¯•

### ğŸ“ æ—¥å¸¸å·¥ä½œæµç¨‹

**å¼€å§‹æµ‹è¯•**:
```bash
# 1. è¿›å…¥ç›®å½•
cd /Users/wanxin/PycharmProjects/Knowlege_PrismaX/QA_PrismaX/backend-test/Test_Framework

# 2. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source testenv/bin/activate

# 3. ç¡®è®¤ç¯å¢ƒï¼ˆå¯é€‰ï¼‰
which python    # åº”æ˜¾ç¤º .../testenv/bin/python
pytest --version

# 4. è¿è¡Œæµ‹è¯•
pytest -v
```

**ç»“æŸæµ‹è¯•**:
```bash
# é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
deactivate
```

### ğŸš€ è¿è¡Œæµ‹è¯•çš„å¤šç§æ–¹å¼

#### æ–¹å¼1: è¿è¡Œå•ä¸ªæµ‹è¯•

```bash
# æµ‹è¯•ç”¨æˆ·ç®¡ç† - å¥åº·æ£€æŸ¥
pytest test_cases/test_user_management.py::TestHealthCheck::test_health_check -v

# æµ‹è¯•æœºå™¨äººçŠ¶æ€
pytest test_cases/test_tele_op.py::TestRobotStatus::test_get_robots_status -v

# æµ‹è¯•ç”¨æˆ·ç®¡ç† - æ‰€æœ‰å¥åº·æ£€æŸ¥
pytest test_cases/test_user_management.py::TestHealthCheck -v

# æµ‹è¯•æœºå™¨äºº - æ‰€æœ‰çŠ¶æ€æ£€æŸ¥
pytest test_cases/test_tele_op.py::TestRobotStatus -v
```

#### æ–¹å¼2: è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰ç”¨æˆ·ç®¡ç†æµ‹è¯•
pytest test_cases/test_user_management.py -v

# è¿è¡Œæ‰€æœ‰æœºå™¨äººæ§åˆ¶æµ‹è¯•
pytest test_cases/test_tele_op.py -v

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest -v
```

#### æ–¹å¼3: ä½¿ç”¨ä¾¿æ·è„šæœ¬

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
./run_tests.sh

# è¿è¡Œç”¨æˆ·ç®¡ç†æµ‹è¯•
./run_tests.sh -s user

# è¿è¡Œæœºå™¨äººæ§åˆ¶æµ‹è¯•
./run_tests.sh -s tele

# è¿è¡Œå¹¶ç”ŸæˆæŠ¥å‘Š
./run_tests.sh -r

# å¹¶è¡Œè¿è¡Œæµ‹è¯•
./run_tests.sh -p 4

# æ¸…ç†åè¿è¡Œ
./run_tests.sh --clean -r
```

### ğŸ¯ å¸¸ç”¨æµ‹è¯•åœºæ™¯

**1. å¿«é€ŸéªŒè¯æœåŠ¡å¯ç”¨æ€§**:
```bash
# åªè¿è¡Œå¥åº·æ£€æŸ¥
pytest test_cases/test_user_management.py::TestHealthCheck -v
pytest test_cases/test_tele_op.py::TestRobotStatus::test_get_robots_status -v
```

**2. æµ‹è¯•ç‰¹å®šåŠŸèƒ½**:
```bash
# æµ‹è¯•ç”¨æˆ·è®¤è¯
pytest test_cases/test_user_management.py::TestAuthentication -v

# æµ‹è¯•é˜Ÿåˆ—ç®¡ç†
pytest test_cases/test_tele_op.py::TestQueueManagement -v
```

**3. è¿è¡Œæ‰€æœ‰æœªè·³è¿‡çš„æµ‹è¯•**:
```bash
# è¿è¡Œæ‰€æœ‰æ²¡æœ‰@pytest.mark.skipæ ‡è®°çš„æµ‹è¯•
pytest -v
```

**4. æ˜¾ç¤ºè¯¦ç»†è¾“å‡º**:
```bash
# æ˜¾ç¤ºæ‰€æœ‰printå’Œæ—¥å¿—
pytest test_cases/test_user_management.py::TestHealthCheck -v -s
```

### ğŸ“Š æµ‹è¯•ç»“æœç¤ºä¾‹

**ç”¨æˆ·ç®¡ç†æœåŠ¡ - å¥åº·æ£€æŸ¥**:
```
âœ… PASSED - test_health_check
å“åº”: 200 OK
çŠ¶æ€: "ok"
è€—æ—¶: 0.26s
```

**æœºå™¨äººæ§åˆ¶æœåŠ¡ - çŠ¶æ€æŸ¥è¯¢**:
```
âœ… PASSED - test_get_robots_status  
å“åº”: 200 OK
æœºå™¨äººæ•°æ®:
  - arm1: é˜Ÿåˆ—220äºº, ä¸å¯ç”¨, ç›´æ’­ä¸­
  - arm2: é˜Ÿåˆ—0äºº, å¯ç”¨, å·²æš‚åœ
è€—æ—¶: 0.66s
```

---

## æµ‹è¯•æŠ¥å‘Š

### ğŸ“ˆ ç”ŸæˆAllureæŠ¥å‘Šï¼ˆæ¨èï¼‰

```bash
# æ–¹å¼1: è¿è¡Œæµ‹è¯•å¹¶è‡ªåŠ¨æ‰“å¼€æŠ¥å‘Š
./run_tests.sh -r

# æ–¹å¼2: æ‰‹åŠ¨ç”Ÿæˆ
pytest
allure serve test_report/allure-results
```

### ğŸ“„ ç”ŸæˆHTMLæŠ¥å‘Š

```bash
# ç”ŸæˆHTMLæŠ¥å‘Š
pytest --html=test_report/report.html --self-contained-html
```

### ğŸ“ æŸ¥çœ‹æµ‹è¯•æ—¥å¿—

```bash
# æŸ¥çœ‹ä»Šå¤©çš„æµ‹è¯•æ—¥å¿—
cat logs/test_$(date +%Y%m%d).log

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/test_$(date +%Y%m%d).log

# æŸ¥çœ‹æœ€è¿‘10æ¡æ—¥å¿—
tail -n 10 logs/test_$(date +%Y%m%d).log

# æŸ¥çœ‹è¯¦ç»†çš„HTTPè¯·æ±‚
cat logs/test_$(date +%Y%m%d).log | grep "Request:"
```

---

## è°ƒè¯•æŠ€å·§

### ğŸ” è°ƒè¯•æ–¹æ³•

**1. è¿è¡Œå¤±è´¥çš„æµ‹è¯•**:
```bash
# åªè¿è¡Œä¸Šæ¬¡å¤±è´¥çš„æµ‹è¯•
pytest --lf -v

# å…ˆè¿è¡Œå¤±è´¥çš„ï¼Œå†è¿è¡Œå…¶ä»–çš„
pytest --ff -v
```

**2. è¿›å…¥è°ƒè¯•æ¨¡å¼**:
```bash
# å¤±è´¥æ—¶è‡ªåŠ¨è¿›å…¥pdbè°ƒè¯•å™¨
pytest --pdb
```

**3. æŸ¥çœ‹è¯¦ç»†çš„HTTPè¯·æ±‚**:
```bash
# æ‰€æœ‰æ—¥å¿—éƒ½åœ¨ logs/test_YYYYMMDD.log ä¸­
cat logs/test_$(date +%Y%m%d).log | grep "Request:"
```

**4. æ˜¾ç¤ºæ‰§è¡Œæ—¶é—´**:
```bash
# æ˜¾ç¤ºæœ€æ…¢çš„10ä¸ªæµ‹è¯•
pytest --durations=10

# æ˜¾ç¤ºæ‰€æœ‰æµ‹è¯•çš„æ‰§è¡Œæ—¶é—´
pytest --durations=0
```

---

## å¸¸è§é—®é¢˜

### Q1: å¿˜è®°æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼Ÿ

**é—®é¢˜**: 
```bash
# çœ‹åˆ°è¿™ä¸ªé”™è¯¯ï¼š
pytest: command not found
```

**è§£å†³æ–¹æ³•**:
```bash
source testenv/bin/activate
```

### Q2: è™šæ‹Ÿç¯å¢ƒæŸåï¼Ÿ

**è§£å†³æ–¹æ³•**:
```bash
# é‡å»ºè™šæ‹Ÿç¯å¢ƒ
rm -rf testenv
python3 -m venv testenv
source testenv/bin/activate
pip install -r requirements.txt
```

### Q3: å¦‚ä½•å…±äº«ç¯å¢ƒç»™å›¢é˜Ÿï¼Ÿ

```bash
# å¯¼å‡ºä¾èµ–
pip freeze > requirements.txt

# å›¢é˜Ÿæˆå‘˜åˆ›å»ºè‡ªå·±çš„ç¯å¢ƒ
python3 -m venv testenv
source testenv/bin/activate
pip install -r requirements.txt
```

### Q4: æµ‹è¯•å¤±è´¥å¦‚ä½•æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Ÿ

```bash
# æ–¹æ³•1: æŸ¥çœ‹AllureæŠ¥å‘Š
allure serve test_report/allure-results

# æ–¹æ³•2: æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
cat logs/test_$(date +%Y%m%d).log

# æ–¹æ³•3: é‡æ–°è¿è¡Œå¤±è´¥çš„æµ‹è¯•å¹¶æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
pytest --lf -v -s
```

---

## ğŸ“‹ æµ‹è¯•è¦†ç›–èŒƒå›´

### ç”¨æˆ·ç®¡ç†æœåŠ¡ (28ä¸ªæ¥å£)
- [x] `/health` - å¥åº·æ£€æŸ¥
- [x] `/api/get-users` - è·å–ç”¨æˆ·ä¿¡æ¯
- [ ] `/auth/send-verification-code` - å‘é€éªŒè¯ç  (éœ€è¦çœŸå®é‚®ç®±)
- [ ] `/auth/verify-code` - éªŒè¯éªŒè¯ç  (éœ€è¦çœŸå®éªŒè¯ç )
- [ ] å…¶ä»–æ¥å£... (å‚è§ test_user_management.py)

### æœºå™¨äººæ§åˆ¶æœåŠ¡ (14ä¸ªæ¥å£)
- [x] `/robots/status` - æœºå™¨äººçŠ¶æ€
- [x] `/get_live_paused_status` - ç›´æ’­æš‚åœçŠ¶æ€  
- [ ] `/queue/join` - åŠ å…¥é˜Ÿåˆ— (éœ€è¦è®¤è¯)
- [ ] `/queue/status` - é˜Ÿåˆ—çŠ¶æ€ (éœ€è¦è®¤è¯)
- [ ] å…¶ä»–æ¥å£... (å‚è§ test_tele_op.py)

---

## ğŸ¨ IDEé…ç½®

### PyCharm
1. æ‰“å¼€é¡¹ç›®
2. Preferences â†’ Project â†’ Python Interpreter
3. æ·»åŠ è§£é‡Šå™¨ â†’ Existing Environment
4. é€‰æ‹©: `testenv/bin/python`

### VS Code
1. Cmd+Shift+P
2. "Python: Select Interpreter"
3. é€‰æ‹© `testenv/bin/python`

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### âœ… è¦åšçš„
- âœ… å§‹ç»ˆåœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œæµ‹è¯•
- âœ… å®šæœŸæ›´æ–° `requirements.txt`
- âœ… ä¸å›¢é˜Ÿåˆ†äº« `requirements.txt`ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿç¯å¢ƒç›®å½•
- âœ… æµ‹è¯•å‰æ¸…ç†æ—§çš„ç¼“å­˜å’Œæ—¥å¿—

### âŒ ä¸è¦åšçš„
- âŒ ä¸è¦æäº¤ `testenv/` åˆ°Gitï¼ˆå·²åœ¨.gitignoreä¸­ï¼‰
- âŒ ä¸è¦åœ¨ç³»ç»ŸPythonä¸­å®‰è£…é¡¹ç›®ä¾èµ–
- âŒ ä¸è¦ç›´æ¥å¤åˆ¶è™šæ‹Ÿç¯å¢ƒç»™ä»–äºº

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **README.md** - å®Œæ•´ä½¿ç”¨æ–‡æ¡£
- **QUICK_START.md** - å¿«é€Ÿå¼€å§‹æŒ‡å—
- **TEST_DESIGN.md** - æµ‹è¯•è®¾è®¡æ–‡æ¡£
- **INSTALL.md** - å®‰è£…æŒ‡å—

---

## âœ¨ ä¸‹ä¸€æ­¥

1. **ç†Ÿæ‚‰è™šæ‹Ÿç¯å¢ƒæ“ä½œ**
   ```bash
   source testenv/bin/activate
   pytest --version
   deactivate
   ```

2. **è¿è¡Œç¬¬ä¸€ä¸ªæµ‹è¯•**
   ```bash
   source testenv/bin/activate
   pytest test_cases/test_user_management.py::TestHealthCheck -v
   ```

3. **æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹**
   - ç§»é™¤æ›´å¤š @pytest.mark.skip æ ‡è®°
   - å‡†å¤‡çœŸå®çš„æµ‹è¯•è´¦å·å’Œæ•°æ®

4. **é…ç½®CI/CD**
   - é›†æˆåˆ°GitLab CI / GitHub Actions
   - è‡ªåŠ¨è¿è¡Œæµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š

5. **æ‰©å±•æµ‹è¯•è¦†ç›–**
   - æ·»åŠ æ€§èƒ½æµ‹è¯•
   - æ·»åŠ å‹åŠ›æµ‹è¯•
   - æ·»åŠ å®‰å…¨æµ‹è¯•

---

## ğŸ’¡ æç¤º

- æµ‹è¯•æ—¥å¿—ä¿å­˜åœ¨ `logs/` ç›®å½•
- AllureæŠ¥å‘Šä¿å­˜åœ¨ `test_report/` ç›®å½•
- æ‰€æœ‰æ¥å£çš„è¯¦ç»†è¯·æ±‚/å“åº”éƒ½ä¼šè¢«è®°å½•
- è™šæ‹Ÿç¯å¢ƒç›®å½• `testenv/` å·²è¢« `.gitignore` å¿½ç•¥

---

**æµ‹è¯•æ¡†æ¶çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ  
**è™šæ‹Ÿç¯å¢ƒ**: âœ… å·²åˆ›å»ºå¹¶éªŒè¯  
**Python**: 3.12.8 (testenv)  
**pytest**: 7.4.3  
**ä¾èµ–**: 29ä¸ªåŒ…å·²å®‰è£…  
**æœ€åéªŒè¯æ—¶é—´**: 2025-10-06  
**ç»´æŠ¤è€…**: QA Team

