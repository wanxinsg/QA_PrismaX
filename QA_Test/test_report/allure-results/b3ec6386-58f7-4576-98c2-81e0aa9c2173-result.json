{"name": "test_queue_update_event", "status": "skipped", "statusDetails": {"message": "XFAIL reason: position 非严格递增或存在重复\n\n_pytest.outcomes.XFailed: position 非严格递增或存在重复", "trace": "socketio_client = (<socketio.client.Client object at 0x1069b0620>, <conftest.QueueEventCollector object at 0x1069b1700>)\nenv_config = EnvConfig(scheme='http', host='localhost', port=8081, base_path='', robot_id='arm1', user_id='1001047', token='QhZewTLifPlcp8I01ZFwCND7F1lKOolpFlbq1fdNA0s')\n\n    @pytest.mark.teleop\n    @allure.feature(\"Tele-Op Queue\")\n    @allure.story(\"Socket.IO queue_update\")\n    def test_queue_update_event(socketio_client, env_config: EnvConfig):\n        sio, collector = socketio_client\n    \n        with allure.step(\"等待首次事件（connection_success 或 queue_update）\"):\n            evt = collector.wait_first(timeout=15.0)\n            assert isinstance(evt, dict), \"事件 payload 应为字典\"\n            et = evt.get(\"_type\")\n            if et == \"connection_success\":\n                allure.attach(str(evt), \"connection_success\", allure.attachment_type.TEXT)\n                # 放宽校验：只要连通即可通过\n                return\n            assert et == \"queue_update\", f\"首个事件应为 queue_update 或 connection_success，实际: {et}\"\n            data = evt.get(\"payload\") or {}\n            assert isinstance(data, dict), \"queue_update payload 应为字典\"\n            assert \"queue\" in data, \"返回中缺少 queue 字段\"\n            queue = data.get(\"queue\", [])\n            allure.attach(str(data), \"queue_update_payload\", allure.attachment_type.TEXT)\n    \n        with allure.step(\"基本结构校验\"):\n            assert \"robotId\" in data and data[\"robotId\"] == env_config.robot_id\n            assert isinstance(queue, list), \"queue 应为列表\"\n    \n        if not queue:\n            pytest.skip(\"当前队列为空，跳过位置和状态等深度校验\")\n    \n        with allure.step(\"位置从 1 开始递增且无重复\"):\n            positions = [item.get(\"position\") for item in queue]\n            if not all(isinstance(p, int) and p > 0 for p in positions):\n                allure.attach(str(positions), \"positions_invalid\", allure.attachment_type.TEXT)\n                pytest.xfail(\"存在非正整数 position\")\n            expected = list(range(1, len(queue) + 1))\n            if positions != expected:\n                allure.attach(f\"expected={expected}\\nactual={positions}\", \"positions_mismatch\", allure.attachment_type.TEXT)\n>               pytest.xfail(\"position 非严格递增或存在重复\")\nE               _pytest.outcomes.XFailed: position 非严格递增或存在重复\n\nQA_PrismaX/Test_Env/test_cases/test_tele_op.py:43: XFailed"}, "steps": [{"name": "等待首次事件（connection_success 或 queue_update）", "status": "passed", "attachments": [{"name": "queue_update_payload", "source": "236b3327-24f1-4a45-87cd-45f4f36ba50d-attachment.txt", "type": "text/plain"}], "start": 1765178656435, "stop": 1765178658638}, {"name": "基本结构校验", "status": "passed", "start": 1765178658638, "stop": 1765178658638}, {"name": "位置从 1 开始递增且无重复", "status": "failed", "statusDetails": {"message": "_pytest.outcomes.XFailed: position 非严格递增或存在重复\n", "trace": "  File \"/Users/wanxin/PycharmProjects/Prismax/QA_PrismaX/Test_Env/test_cases/test_tele_op.py\", line 43, in test_queue_update_event\n    pytest.xfail(\"position 非严格递增或存在重复\")\n  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/_pytest/outcomes.py\", line 206, in xfail\n    raise XFailed(reason)\n"}, "attachments": [{"name": "positions_mismatch", "source": "c96dbd41-4b34-4d40-b58b-7ac1d7e4c205-attachment.txt", "type": "text/plain"}], "start": 1765178658638, "stop": 1765178658638}], "attachments": [{"name": "stderr", "source": "6c9f91f3-fcc7-478a-afd2-721e54c69329-attachment.txt", "type": "text/plain"}], "start": 1765178656435, "stop": 1765178658639, "uuid": "c090ddd7-84ae-420d-b79c-6571967ea74e", "historyId": "773b7531ed0647384aad5e3e2f50c0d7", "testCaseId": "773b7531ed0647384aad5e3e2f50c0d7", "fullName": "test_cases.test_tele_op#test_queue_update_event", "labels": [{"name": "story", "value": "Socket.IO queue_update"}, {"name": "feature", "value": "Tele-Op Queue"}, {"name": "tag", "value": "teleop"}, {"name": "parentSuite", "value": "test_cases"}, {"name": "suite", "value": "test_tele_op"}, {"name": "host", "value": "wanxins-MacBook-Pro.local"}, {"name": "thread", "value": "11006-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cases.test_tele_op"}]}